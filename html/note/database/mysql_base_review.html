<!DOCTYPE HTML>
<html>
    <head>
        <title>MySQL基础复习</title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <link rel="Stylesheet" type="text/css" href="../../../public/css/main.css" />
        <!-- blog ico -->
        <link type="image/x-icon" rel="icon" href="../../../public/images/spring.ico" />
        <link type="image/x-icon" rel="shortcut icon" href="../../../public/images/spring.ico" />
        <!-- highlightjs -->
        <link rel="stylesheet" href="../../../public/highlightjs/styles/monokai.css">
        <script src="../../../public/highlightjs/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>
    </head>
    <body>
        <center style="font-family: 'Microsoft Yahei', sans-serif; font-size: 1.80em;
            font-weight: normal; color: #FF6600">Simone's Strawberry Yard</center><br />
        <center>Oracle, Linux and Others</center>


        

<p>
<a href="../../index.html">首页</a> - <a href="../index.html">Note</a> - <a href="index.html">DataBase</a>
</p>
<h2 id="toc_0.1">MySQL基础复习</h2>
<hr />
<h3 id="toc_0.1.1">常用查询语句</h3>

<ul>
<li>
过滤重复数据：<code>select distinct ...</code>（<code>distinct</code> 必须放在所有列名的前面，且影响的是所有列而不是某指定的一列）

<li>
返回结果中从第 <code>2</code> 行开始的 <code>5</code> 行记录：<code>limit 1,5</code>，也可写作 <code>limit 5 offset 1</code>（第一行为 <code>0</code>，第二行为 <code>1</code>）

<li>
通配符 <code>%</code>：任何字符出现任意次数

<li>
通配符 <code>_</code>：任何字符出现一次

<li>
使用正则：<code>regexp '正则表达式'</code>

<li>
区分大小写的正则：<code>regexp binary '正则表达式'</code>

<li>
正则转义特殊字符：就像 <code>PHP</code> 的正则处理方式一样，需要使用两个反斜杠，如 <code>\\.</code>

<li>
可在 <code>MySQL</code> 交互工具中直接测试正则表达式是否匹配，总是返回 <code>1</code> 或者 <code>0</code>，如：<code>select 'hello 123' regexp 'lo [0-9]{3}';</code>

<li>
分组数据：<code>group by ...</code>

<li>
过滤分组：<code>having ...</code>（用法与 <code>where</code> 一样，只是 <code>where</code> 用于过滤行，而 <code>having</code> 用于过滤组）

<li>
<code>where</code> 和 <code>having</code> 的另一种理解：<code>where</code> 在分组之前过滤，<code>having</code> 在分组之后过滤

<li>
<code>group by</code> 和 <code>order by</code> 的重要区别：<code>order by</code> 可以使用自定义列名，而 <code>group by</code> 则必须使用表自己所拥有的列名

<li>
多表联结：<code>select ... from tab1, tab2 where tab1.xx = tab2.xx ...</code>

<li>
多种联结类型：<code>inner join</code>（交集）、<code>A left join B</code>（以表 <code>A</code> 为准）、<code>A right join B</code>（以表 <code>B</code> 为准）

<li>
多条查询语句组合：<code>select ... from ... union select ... from ...</code>

</ul>

<p>
查询语句的书写顺序：
</p>
<pre>
select ...
from ...
where ...
group by ...
having ...
order by ...
limit ...
</pre>

<p>
全文本搜索：
</p>
<ol>
<li>
必须选择 <code>MyISAM</code> 引擎

<li>
建表时使用 <code>fulltext</code> 对指定列建索引

<li>
查询时使用 <code>match()</code> 函数指定需要搜索的列，使用 <code>against()</code> 函数指定要使用的搜索表达式

<li>
返回的结果会按匹配的程度排序，匹配度越好的在越前

<li>
在 <code>against()</code> 里面使用 <code>with query expansion</code> 可以开启扩展查询

<li>
在 <code>against()</code> 里面使用 <code>in boolean mode</code> 可以开启布尔搜索模式

<li>
布尔模式下可使用 <code>+</code>、<code>-</code>、<code>&gt;</code>、<code>&lt;</code>、<code>()</code>、<code>~</code>、<code>*</code>、<code>""</code> 等对全文本搜索进行精确的控制

</ol>
<hr />
<h3 id="toc_0.1.2">常用内建函数</h3>

<ul>
<li>
获取当前日期和时间：<code>now()</code>

<li>
获取日期：<code>date(参数)</code>

<li>
获取时间：<code>time(参数)</code>

<li>
获取年份：<code>year(参数)</code>

<li>
获取月份：<code>month(参数)</code>

<li>
获取天数：<code>day(参数)</code>

<li>
获取星期：<code>dayofweek(参数)</code>

<li>
获取小时：<code>hour(参数)</code>

<li>
获取分钟：<code>minute(参数)</code>

<li>
获取秒数：<code>second(参数)</code>

<li>
连接字符串：<code>concat(参数1, 参数2, ...)</code>

<li>
去除左右两边的空格：<code>trim(参数)</code>、<code>ltrim(参数)</code>、<code>rtrim(参数)</code>

<li>
转换成大写：<code>upper(参数)</code>

<li>
转换成小写：<code>lower(参数)</code>

<li>
计算串的长度：<code>length(参数)</code>

<li>
返回最后一个自增值：<code>last_insert_id()</code>

</ul>
<hr />
<h3 id="toc_0.1.3">聚集函数</h3>

<ul>
<li>
返回某列的记录条数：<code>count(列名)</code>，<code>count(*)</code> 会包含 <code>NULL</code> 值

<li>
返回某列的数值之和：<code>sum(列名)</code>

<li>
返回某列的平均值：<code>avg(列名)</code>

<li>
返回某列的最大值：<code>max(列名)</code>

<li>
返回某列的最小值：<code>min(列名)</code>

</ul>
<hr />
<h3 id="toc_0.1.4">变更数据</h3>

<ul>
<li>
插入新数据：
<pre>
insert into tab_name (列列表)
values
(值列表1),
(值列表2),
...
(值列表N);
</pre>

<li>
插入检索出的数据：
<pre>
insert into tabA_name (列列表)
select ... from tabB_name where ...;
</pre>

<li>
更新数据：
<pre>
update tab_name
set
列1 = 值1,
列2 = 值2,
...
列N = 值N
where ...;
</pre>

<li>
删除记录：
<pre>
delete from tab_name
where ...;
</pre>

</ul>
<hr />
<h3 id="toc_0.1.5">变更数据表</h3>

<ol>
<li>
创建表：
<pre>
create table tab_name
(...) ...;
</pre>

<li>
增加列/外键等：
<pre>
alter table tab_name
add ...;
</pre>

<li>
删除列：
<pre>
alter table tab_name
drop column ...;
</pre>

<li>
重命名表：
<pre>
rename table old_tab_name to new_tab_name;
</pre>

<li>
删除表：
<pre>
drop table tab_name;
</pre>

</ol>
<hr />
<h3 id="toc_0.1.6">视图</h3>

<p>
视图相当于一种代码重用机制，避免多次书写同一代码
</p>

<ul>
<li>
创建视图：
<pre>
create view view_name as
select ... from ... where ...;
</pre>

</ul>
<hr />
<h3 id="toc_0.1.7">存储过程</h3>

<p>
存储过程相当于编程语言里的函数，用于多次调用
</p>

<ul>
<li>
创建：
<pre>
create procedure pro_name (参数表列)
begin
    ...
end;
</pre>

<li>
调用：
<pre>
call pro_name (传递参数);
</pre>

<li>
删除：
<pre>
drop procedure pro_name;
</pre>

<li>
显示创建存储过程的 <code>SQL</code> 代码：
<pre>
show create procedure pro_name;
</pre>

<li>
显示所有存储过程状态：
<pre>
show procedure status;
</pre>

</ul>
<hr />
<h3 id="toc_0.1.8">游标</h3>

<ul>
<li>
声明游标：
<pre>
declare cur_name cursor
for
select ... from ... where ...;
</pre>

<li>
打开游标：
<pre>
open cur_name;
</pre>

<li>
使用游标：
<pre>
fetch cur_name into var_name;
</pre>

<li>
关闭游标：
<pre>
close cur_name;
</pre>

</ul>
<hr />
<h3 id="toc_0.1.9">触发器</h3>

<ul>
<li>
触发器支持的响应：<code>INSERT</code>、<code>UPDATE</code>、<code>DELETE</code>

<li>
只有表支持触发器，视图和临时表都不支持

<li>
每个表最多支持 <code>6</code> 个触发器（每条 <code>INSERT</code>、<code>UPDATE</code>、<code>DELETE</code> 语句之前或之后）

<li>
触发器只能先删除再重建，不能直接修改

<li>
创建触发器：
<pre>
create trigger tri_name before/after insert/update/delete on tab_name
...;
</pre>

<li>
删除触发器：
<pre>
drop trigger tri_name;
</pre>

</ul>
<hr />
<h3 id="toc_0.1.10">事务</h3>

<ul>
<li>
必须使用 <code>InnoDB</code> 存储引擎

<li>
事务支持管理的操作：<code>INSERT</code>、<code>UPDATE</code>、<code>DELETE</code>

<li>
标识事务的开始：
<pre>
start transaction;
</pre>

<li>
事务回滚：
<pre>
rollback;
</pre>

<li>
手动提交：
<pre>
commit;
</pre>

<li>
设置保留点：
<pre>
savepoint poi_name;
</pre>

</ul>
<hr />
<p>
<red>date</red> : 2014-03-21、2014-03-22、2014-03-23、2014-03-24、2014-03-25
<hr />
</p>



        <center  style="font-family: 'Microsoft Yahei'; font-size: small; font-weight: normal; color: #009933">
            Simone Chen&nbsp;&copy;&nbsp;2012-2014&nbsp;nksimone.github.io
        </center>


        <!-- 腾讯分析统计代码 -->
        <script type="text/javascript" src="http://tajs.qq.com/stats?sId=9124871" charset="UTF-8"></script>

    </body>
</html>
